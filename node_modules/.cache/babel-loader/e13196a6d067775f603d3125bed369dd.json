{"ast":null,"code":"import { combineLatest } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { apiData$ } from 'services/observables/pools';\nimport BigNumber from 'bignumber.js';\nimport numbro from 'numbro';\nexport const statistics$ = combineLatest([apiData$]).pipe(map(_ref => {\n  let [apiData] = _ref;\n  const averageFormat = {\n    average: true,\n    mantissa: 2,\n    optionalMantissa: true,\n    spaceSeparated: true,\n    lowPrecision: false\n  };\n  const bnt24hChange = new BigNumber(apiData.bnt_price.usd).div(apiData.bnt_price_24h_ago.usd).times(100).minus(100).toNumber();\n  const liquidity24hChange = new BigNumber(apiData.total_liquidity.usd).div(apiData.total_liquidity_24h_ago.usd).times(100).minus(100).toNumber();\n  const fees24hChange = new BigNumber(apiData.total_fees_24h.usd).div(apiData.total_fees_24h_ago.usd).times(100).minus(100).toNumber();\n  const bntAddress = '0x1F573D6Fb3F13d689FF844B4cE37794d79a7FF1C';\n  const bntSupply = apiData.bnt_supply;\n  const totalBntStaked = apiData.pools.reduce((acc, item) => {\n    const bntReserve = item.reserves.find(reserve => reserve.address.toLowerCase() === bntAddress.toLowerCase());\n    if (!bntReserve) return acc;\n    return Number(bntReserve.balance) + acc;\n  }, 0);\n  const stakedBntPercent = totalBntStaked / Number(parseFloat(bntSupply).toExponential(18)) * 100;\n  const statistics = [{\n    label: 'BNT Price',\n    value: '$' + numbro(apiData.bnt_price.usd).format({\n      mantissa: 2\n    }),\n    change24h: bnt24hChange\n  }, {\n    label: 'Total Liquidity',\n    value: '$' + numbro(apiData.total_liquidity.usd).format(averageFormat),\n    change24h: liquidity24hChange\n  }, {\n    label: 'Fees (24h)',\n    value: '$' + numbro(apiData.total_fees_24h.usd).format(averageFormat),\n    change24h: fees24hChange\n  }, {\n    label: 'Total BNT Staked',\n    value: numbro(stakedBntPercent).format({\n      mantissa: 2\n    }) + '%'\n  }];\n  return statistics;\n}), shareReplay(1));","map":{"version":3,"sources":["/Users/safahi/Desktop/webapp-v2-feature-gtm_events/src/services/observables/statistics.ts"],"names":["combineLatest","map","shareReplay","apiData$","BigNumber","numbro","statistics$","pipe","apiData","averageFormat","average","mantissa","optionalMantissa","spaceSeparated","lowPrecision","bnt24hChange","bnt_price","usd","div","bnt_price_24h_ago","times","minus","toNumber","liquidity24hChange","total_liquidity","total_liquidity_24h_ago","fees24hChange","total_fees_24h","total_fees_24h_ago","bntAddress","bntSupply","bnt_supply","totalBntStaked","pools","reduce","acc","item","bntReserve","reserves","find","reserve","address","toLowerCase","Number","balance","stakedBntPercent","parseFloat","toExponential","statistics","label","value","format","change24h"],"mappings":"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","sourcesContent":["import { combineLatest } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { apiData$ } from 'services/observables/pools';\nimport BigNumber from 'bignumber.js';\nimport numbro from 'numbro';\n\nexport interface Statistic {\n  label: string;\n  value: string;\n  change24h?: number;\n}\n\nexport const statistics$ = combineLatest([apiData$]).pipe(\n  map(([apiData]) => {\n    const averageFormat = {\n      average: true,\n      mantissa: 2,\n      optionalMantissa: true,\n      spaceSeparated: true,\n      lowPrecision: false,\n    };\n\n    const bnt24hChange = new BigNumber(apiData.bnt_price.usd!)\n      .div(apiData.bnt_price_24h_ago.usd!)\n      .times(100)\n      .minus(100)\n      .toNumber();\n\n    const liquidity24hChange = new BigNumber(apiData.total_liquidity.usd!)\n      .div(apiData.total_liquidity_24h_ago.usd!)\n      .times(100)\n      .minus(100)\n      .toNumber();\n\n    const fees24hChange = new BigNumber(apiData.total_fees_24h.usd!)\n      .div(apiData.total_fees_24h_ago.usd!)\n      .times(100)\n      .minus(100)\n      .toNumber();\n\n    const bntAddress = '0x1F573D6Fb3F13d689FF844B4cE37794d79a7FF1C';\n    const bntSupply: string = apiData.bnt_supply;\n    const totalBntStaked: number = apiData.pools.reduce((acc, item) => {\n      const bntReserve = item.reserves.find(\n        (reserve) => reserve.address.toLowerCase() === bntAddress.toLowerCase()\n      );\n      if (!bntReserve) return acc;\n      return Number(bntReserve.balance) + acc;\n    }, 0);\n\n    const stakedBntPercent =\n      (totalBntStaked / Number(parseFloat(bntSupply).toExponential(18))) * 100;\n\n    const statistics: Statistic[] = [\n      {\n        label: 'BNT Price',\n        value: '$' + numbro(apiData.bnt_price.usd).format({ mantissa: 2 }),\n        change24h: bnt24hChange,\n      },\n      {\n        label: 'Total Liquidity',\n        value: '$' + numbro(apiData.total_liquidity.usd).format(averageFormat),\n        change24h: liquidity24hChange,\n      },\n      {\n        label: 'Fees (24h)',\n        value: '$' + numbro(apiData.total_fees_24h.usd).format(averageFormat),\n        change24h: fees24hChange,\n      },\n      {\n        label: 'Total BNT Staked',\n        value: numbro(stakedBntPercent).format({ mantissa: 2 }) + '%',\n      },\n    ];\n    return statistics;\n  }),\n  shareReplay(1)\n);\n"]},"metadata":{},"sourceType":"module"}